<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TNI OSINT Database - Secure Access</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .terminal-effect::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.15) 0px,
                rgba(0, 0, 0, 0.15) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 1000;
        }

        /* Login Screen */
        #loginScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s;
        }

        .login-container {
            background: #111;
            padding: 40px;
            border-radius: 5px;
            border: 1px solid #333;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.2);
            width: 90%;
            max-width: 500px;
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-header h1 {
            color: #00ff00;
            font-size: 24px;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }

        .login-header p {
            color: #888;
            font-size: 14px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #ccc;
            font-size: 14px;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            background: #222;
            border: 1px solid #333;
            border-radius: 3px;
            color: #00ff00;
            font-size: 16px;
            letter-spacing: 1px;
        }

        .input-group input:focus {
            outline: none;
            border-color: #00ff00;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background: #003300;
            color: #00ff00;
            border: 1px solid #005500;
            border-radius: 3px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .login-btn:hover {
            background: #005500;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.4);
        }

        .error-message {
            color: #ff3333;
            text-align: center;
            margin-top: 15px;
            font-size: 14px;
            min-height: 20px;
        }

        /* Main Interface */
        #mainInterface {
            display: none;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid #333;
        }

        .header h1 {
            color: #fff;
            font-size: 32px;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .header .subtitle {
            color: #888;
            font-size: 14px;
        }

        .search-container {
            max-width: 800px;
            margin: 0 auto 40px;
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-box input {
            flex: 1;
            padding: 15px;
            background: #111;
            border: 1px solid #333;
            border-radius: 3px;
            color: #fff;
            font-size: 16px;
        }

        .search-box input:focus {
            outline: none;
            border-color: #00ff00;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.3);
        }

        .search-btn {
            padding: 15px 25px;
            background: #003300;
            color: #00ff00;
            border: 1px solid #005500;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .search-btn:hover {
            background: #005500;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.4);
        }

        /* Data Management */
        .data-management {
            background: #111;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 25px;
            margin-bottom: 40px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .section-title {
            color: #00ff00;
            margin-bottom: 20px;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .data-form {
            display: grid;
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            color: #ccc;
            font-size: 14px;
        }

        .form-group input,
        .form-group textarea {
            padding: 12px;
            background: #222;
            border: 1px solid #333;
            border-radius: 3px;
            color: #fff;
            font-size: 14px;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .form-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .add-btn {
            background: #003300;
            color: #00ff00;
            border: 1px solid #005500;
        }

        .add-btn:hover {
            background: #005500;
        }

        .clear-btn {
            background: #330000;
            color: #ff3333;
            border: 1px solid #550000;
        }

        .clear-btn:hover {
            background: #550000;
        }

        /* Results Display */
        .results-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .result-card {
            background: #111;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .result-card:hover {
            border-color: #00ff00;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.1);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }

        .identifier {
            color: #00ff00;
            font-size: 18px;
            font-weight: bold;
        }

        .delete-btn {
            background: #330000;
            color: #ff3333;
            border: 1px solid #550000;
            padding: 5px 15px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        .delete-btn:hover {
            background: #550000;
        }

        .data-content {
            color: #ccc;
            line-height: 1.6;
            white-space: pre-wrap;
        }

        .no-results {
            text-align: center;
            color: #888;
            padding: 40px;
            font-style: italic;
        }

        /* Stats */
        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #333;
            color: #888;
            font-size: 14px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            color: #00ff00;
            font-size: 24px;
            font-weight: bold;
        }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #333;
            color: #555;
            font-size: 12px;
        }

        /* Glitch Effect */
        .glitch {
            position: relative;
            animation: glitch 5s infinite;
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            1% { transform: translate(-2px, 2px); }
            2% { transform: translate(2px, -2px); }
            3% { transform: translate(0); }
            100% { transform: translate(0); }
        }

        /* API Results Specific */
        .api-results-section {
            margin-top: 40px;
            border-top: 1px solid #333;
            padding-top: 20px;
        }

        .api-result-card {
            background: #111;
            border: 1px solid #444;
            border-left: 4px solid #ff9900;
            border-radius: 5px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .api-result-header {
            color: #ff9900;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .roblox-avatar {
            width: 100px;
            height: 100px;
            border-radius: 5px;
            border: 2px solid #00a2ff;
            margin-right: 15px;
            float: left;
        }

        .roblox-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .info-item {
            background: #222;
            padding: 10px;
            border-radius: 3px;
            border-left: 3px solid #00a2ff;
        }

        .info-label {
            color: #aaa;
            font-size: 12px;
            margin-bottom: 5px;
        }

        .info-value {
            color: #fff;
            font-weight: bold;
        }

        .online-status {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .online {
            background: #00ff00;
            box-shadow: 0 0 10px #00ff00;
        }

        .offline {
            background: #ff3333;
        }

        .ingame {
            background: #ff9900;
            box-shadow: 0 0 10px #ff9900;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .login-container {
                padding: 20px;
            }
            
            .search-box {
                flex-direction: column;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .stats {
                flex-direction: column;
                gap: 15px;
            }
            
            .roblox-info-grid {
                grid-template-columns: 1fr;
            }
            
            .roblox-avatar {
                float: none;
                margin: 0 auto 15px;
                display: block;
            }
        }
    </style>
</head>
<body class="terminal-effect">
    <!-- Login Screen -->
    <div id="loginScreen">
        <div class="login-container">
            <div class="login-header">
                <h1 class="glitch">TNI OSINT DATABASE</h1>
                <p>Secure Access Required</p>
            </div>
            <div class="input-group">
                <label for="password"><i class="fas fa-key"></i> ACCESS PASSWORD</label>
                <input type="password" id="password" placeholder="Enter system password..." autocomplete="off">
            </div>
            <button class="login-btn" onclick="attemptLogin()">
                <i class="fas fa-terminal"></i> INITIATE SYSTEM
            </button>
            <div class="error-message" id="loginError"></div>
        </div>
    </div>

    <!-- Main Interface -->
    <div id="mainInterface">
        <div class="header">
            <h1 class="glitch">TNI OSINT DATABASE v1.0</h1>
            <div class="subtitle">SECURE INTELLIGENCE MANAGEMENT SYSTEM</div>
        </div>

        <!-- Search Section -->
        <div class="search-container">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Enter identifier (email, username, phone, Roblox ID/Username)..." autocomplete="off">
                <button class="search-btn" onclick="enhancedSearch()">
                    <i class="fas fa-search"></i> ENHANCED SEARCH
                </button>
            </div>
            <div style="margin-top: 10px; color: #666; font-size: 12px; text-align: center;">
                <i class="fas fa-info-circle"></i> Supports: Local DB lookup & Roblox user check
            </div>
        </div>

        <!-- Data Management -->
        <div class="data-management">
            <h2 class="section-title"><i class="fas fa-database"></i> DATABASE MANAGEMENT</h2>
            <div class="data-form">
                <div class="form-group">
                    <label for="identifierInput">IDENTIFIER *</label>
                    <input type="text" id="identifierInput" placeholder="example123@gmail.com" autocomplete="off">
                </div>
                <div class="form-group">
                    <label for="dataInput">INTELLIGENCE DATA *</label>
                    <textarea id="dataInput" placeholder="Enter all gathered intelligence here...
Name: John Doe
Location: New York, NY
Phone: (555) 123-4567
IP History: 192.168.1.1, 10.0.0.1
Social Media: @johndoe_insta, @johndoe_twitter
Additional Notes: Subject uses VPN frequently"></textarea>
                </div>
                <div class="form-actions">
                    <button class="form-btn add-btn" onclick="addData()">
                        <i class="fas fa-plus"></i> ADD TO DATABASE
                    </button>
                    <button class="form-btn clear-btn" onclick="clearForm()">
                        <i class="fas fa-eraser"></i> CLEAR FORM
                    </button>
                </div>
            </div>
        </div>

        <!-- Results Display -->
        <div class="results-container">
            <h2 class="section-title"><i class="fas fa-search"></i> QUERY RESULTS</h2>
            <div id="resultsDisplay">
                <!-- Local database results appear here -->
            </div>
            
            <!-- API Results Section -->
            <div id="apiResultsSection" class="api-results-section" style="display: none;">
                <h2 class="section-title"><i class="fas fa-globe"></i> API RESULTS</h2>
                <div id="apiResultsDisplay">
                    <!-- API results appear here -->
                </div>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats">
            <div class="stat-item">
                <div class="stat-value" id="totalEntries">0</div>
                <div>TOTAL ENTRIES</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="lastSearch">-</div>
                <div>LAST SEARCH</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="databaseSize">0KB</div>
                <div>DATABASE SIZE</div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>TNI OSINT SYSTEM ‚Ä¢ ENCRYPTED LOCAL STORAGE ‚Ä¢ ACCESS LOGGED</p>
            <p>System Status: <span style="color:#00ff00;">OPERATIONAL</span> | Connection: SECURE</p>
        </div>
    </div>

    <script>
        // ====================
        // CORE CONFIGURATION
        // ====================
        const SYSTEM_PASSWORD = "GodOfTNI7";
        let isAuthenticated = false;
        let osintDatabase = JSON.parse(localStorage.getItem('tniOsintDatabase')) || [];

        // ====================
        // LOGIN SYSTEM
        // ====================
        function attemptLogin() {
            const passwordInput = document.getElementById('password').value;
            const errorElement = document.getElementById('loginError');
            
            if (passwordInput === SYSTEM_PASSWORD) {
                isAuthenticated = true;
                document.getElementById('loginScreen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loginScreen').style.display = 'none';
                    document.getElementById('mainInterface').style.display = 'block';
                    updateStats();
                    typeWriter();
                }, 500);
            } else {
                errorElement.textContent = "ACCESS DENIED: Invalid credentials";
                document.getElementById('password').value = '';
                document.getElementById('password').style.borderColor = '#ff3333';
                setTimeout(() => {
                    errorElement.textContent = '';
                    document.getElementById('password').style.borderColor = '#333';
                }, 3000);
            }
        }

        document.getElementById('password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') attemptLogin();
        });

        function typeWriter() {
            const subtitle = document.querySelector('.subtitle');
            const originalText = subtitle.textContent;
            subtitle.textContent = '';
            let i = 0;
            
            function type() {
                if (i < originalText.length) {
                    subtitle.textContent += originalText.charAt(i);
                    i++;
                    setTimeout(type, 50);
                }
            }
            type();
        }

        // ====================
        // LOCAL DATABASE FUNCTIONS
        // ====================
        function addData() {
            if (!isAuthenticated) return;
            
            const identifier = document.getElementById('identifierInput').value.trim();
            const data = document.getElementById('dataInput').value.trim();
            
            if (!identifier || !data) {
                alert("Both identifier and data are required!");
                return;
            }
            
            const existingIndex = osintDatabase.findIndex(item => item.identifier === identifier);
            
            if (existingIndex !== -1) {
                if (confirm("Identifier already exists. Update existing entry?")) {
                    osintDatabase[existingIndex].data = data;
                    osintDatabase[existingIndex].timestamp = new Date().toISOString();
                } else {
                    return;
                }
            } else {
                osintDatabase.push({
                    identifier: identifier,
                    data: data,
                    timestamp: new Date().toISOString(),
                    id: Date.now()
                });
            }
            
            localStorage.setItem('tniOsintDatabase', JSON.stringify(osintDatabase));
            clearForm();
            updateStats();
            showNotification(`Entry ${existingIndex !== -1 ? 'updated' : 'added'} successfully`);
        }

        function searchLocalDatabase(searchTerm) {
            return osintDatabase.filter(item => 
                item.identifier.toLowerCase().includes(searchTerm.toLowerCase()) || 
                item.data.toLowerCase().includes(searchTerm.toLowerCase())
            );
        }

        function displayLocalResults(results) {
            const resultsDisplay = document.getElementById('resultsDisplay');
            if (!resultsDisplay) return;
            
            if (results.length === 0) {
                resultsDisplay.innerHTML = '<div class="no-results">No local database matches found</div>';
            } else {
                let html = '<div style="margin-bottom: 20px; color: #00ff00; font-size: 18px;"><i class="fas fa-database"></i> Server Data</div>';
                
                results.forEach(item => {
                    html += `
                        <div class="result-card">
                            <div class="result-header">
                                <div class="identifier">${escapeHtml(item.identifier)}</div>
                                <button class="delete-btn" onclick="deleteEntry(${item.id})">
                                    <i class="fas fa-trash"></i> DELETE
                                </button>
                            </div>
                            <div class="data-content">${escapeHtml(item.data).replace(/\n/g, '<br>')}</div>
                            <div style="margin-top: 15px; color: #666; font-size: 12px;">
                                Last Updated: ${new Date(item.timestamp).toLocaleString()}
                            </div>
                        </div>
                    `;
                });
                
                resultsDisplay.innerHTML = html;
            }
        }

        function deleteEntry(id) {
            if (!isAuthenticated || !confirm("Permanently delete this entry?")) return;
            
            osintDatabase = osintDatabase.filter(item => item.id !== id);
            localStorage.setItem('tniOsintDatabase', JSON.stringify(osintDatabase));
            enhancedSearch();
            updateStats();
            showNotification("Entry deleted");
        }

        function clearForm() {
            document.getElementById('identifierInput').value = '';
            document.getElementById('dataInput').value = '';
        }

        // ====================
        // ROBLOX API FUNCTIONS
        // ====================
        async function checkRobloxUser(query) {
            try {
                let userId = query;
                
                // If query is not numeric, try to get user ID from username
                if (!/^\d+$/.test(query)) {
                    const idResponse = await fetch('https://users.roblox.com/v1/usernames/users', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            usernames: [query],
                            excludeBannedUsers: false
                        })
                    });
                    
                    if (idResponse.ok) {
                        const idData = await idResponse.json();
                        if (idData.data && idData.data.length > 0) {
                            userId = idData.data[0].id;
                        } else {
                            return { error: "Roblox user not found" };
                        }
                    } else {
                        return { error: "Failed to lookup username" };
                    }
                }
                
                // Fetch user data
                const userResponse = await fetch(`https://users.roblox.com/v1/users/${userId}`);
                if (!userResponse.ok) {
                    return { error: "Failed to fetch user data" };
                }
                
                const userData = await userResponse.json();
                
                // Fetch avatar data
                const avatarResponse = await fetch(`https://thumbnails.roblox.com/v1/users/avatar?userIds=${userId}&size=420x420&format=Png&isCircular=false`);
                let avatarUrl = null;
                if (avatarResponse.ok) {
                    const avatarData = await avatarResponse.json();
                    if (avatarData.data && avatarData.data.length > 0) {
                        avatarUrl = avatarData.data[0].imageUrl;
                    }
                }
                
                // Fetch friends count
                const friendsResponse = await fetch(`https://friends.roblox.com/v1/users/${userId}/friends/count`);
                let friendsCount = 0;
                if (friendsResponse.ok) {
                    const friendsData = await friendsResponse.json();
                    friendsCount = friendsData.count || 0;
                }
                
                // Fetch groups
                const groupsResponse = await fetch(`https://groups.roblox.com/v1/users/${userId}/groups/roles`);
                let groups = [];
                if (groupsResponse.ok) {
                    const groupsData = await groupsResponse.json();
                    groups = groupsData.data ? groupsData.data.slice(0, 5) : [];
                }
                
                // Fetch presence (online status)
                let presence = { userPresenceType: 0, lastLocation: "Offline" };
                try {
                    const presenceResponse = await fetch(`https://presence.roblox.com/v1/presence/users`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            userIds: [userId]
                        })
                    });
                    
                    if (presenceResponse.ok) {
                        const presenceData = await presenceResponse.json();
                        if (presenceData.userPresences && presenceData.userPresences.length > 0) {
                            presence = presenceData.userPresences[0];
                        }
                    }
                } catch (e) {
                    console.log("Presence check failed:", e);
                }
                
                return {
                    success: true,
                    data: {
                        id: userData.id,
                        username: userData.name,
                        displayName: userData.displayName,
                        description: userData.description || "No description",
                        created: new Date(userData.created).toLocaleDateString(),
                        isBanned: userData.isBanned,
                        hasVerifiedBadge: userData.hasVerifiedBadge,
                        avatarUrl: avatarUrl,
                        friendsCount: friendsCount,
                        groups: groups,
                        presence: presence,
                        profileUrl: `https://www.roblox.com/users/${userId}/profile`,
                        lastUpdated: new Date().toLocaleString()
                    }
                };
                
            } catch (error) {
                console.error("Roblox API error:", error);
                return { error: "Failed to fetch Roblox data. User may not exist or API is down." };
            }
        }

        function displayRobloxResults(robloxData, query) {
            const apiSection = document.getElementById('apiResultsSection');
            const apiDisplay = document.getElementById('apiResultsDisplay');
            
            if (!apiSection || !apiDisplay) return;
            
            apiSection.style.display = 'block';
            
            if (robloxData.error) {
                apiDisplay.innerHTML = `
                    <div class="api-result-card">
                        <div class="api-result-header">
                            <i class="fas fa-robot"></i> Roblox Lookup Failed
                        </div>
                        <div class="data-content" style="color: #ff3333;">
                            <i class="fas fa-exclamation-triangle"></i> ${escapeHtml(robloxData.error)}
                        </div>
                    </div>
                `;
                return;
            }
            
            const data = robloxData.data;
            const presenceType = data.presence.userPresenceType;
            let status = "Offline";
            let statusClass = "offline";
            
            if (presenceType === 2) {
                status = "Online";
                statusClass = "online";
            } else if (presenceType === 3) {
                status = "In-Game";
                statusClass = "ingame";
            }
            
            let groupsHtml = '';
            if (data.groups && data.groups.length > 0) {
                data.groups.forEach(group => {
                    groupsHtml += `<div style="background: #222; padding: 5px 10px; border-radius: 3px; margin: 2px; display: inline-block; font-size: 12px;">
                                    ${escapeHtml(group.group.name)} (${group.role.name})
                                  </div>`;
                });
            } else {
                groupsHtml = '<div style="color: #888; font-style: italic;">No groups found</div>';
            }
            
            apiDisplay.innerHTML = `
                <div class="api-result-card">
                    <div class="api-result-header">
                        <i class="fas fa-robot"></i> Roblox User: ${escapeHtml(data.username)} (ID: ${data.id})
                    </div>
                    
                    ${data.avatarUrl ? `<img src="${data.avatarUrl}" class="roblox-avatar" alt="Avatar">` : ''}
                    
                    <div style="overflow: hidden;">
                        <div style="margin-bottom: 15px;">
                            <span class="online-status ${statusClass}"></span>
                            <strong>Status:</strong> ${status}
                            ${data.presence.lastLocation && data.presence.lastLocation !== "Offline" ? 
                                `<div style="color: #aaa; font-size: 12px; margin-top: 5px;">
                                    <i class="fas fa-map-marker-alt"></i> ${escapeHtml(data.presence.lastLocation)}
                                </div>` : ''
                            }
                        </div>
                        
                        <div class="roblox-info-grid">
                            <div class="info-item">
                                <div class="info-label">Display Name</div>
                                <div class="info-value">${escapeHtml(data.displayName)}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Account Created</div>
                                <div class="info-value">${data.created}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Friends</div>
                                <div class="info-value">${data.friendsCount}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Verified</div>
                                <div class="info-value">${data.hasVerifiedBadge ? '‚úÖ Yes' : '‚ùå No'}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Banned</div>
                                <div class="info-value">${data.isBanned ? 'üî¥ Yes' : 'üü¢ No'}</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px; clear: both;">
                            <div style="color: #00a2ff; margin-bottom: 10px; font-size: 14px;">
                                <i class="fas fa-users"></i> Groups (Top 5)
                            </div>
                            ${groupsHtml}
                        </div>
                        
                        ${data.description && data.description !== "No description" ? `
                            <div style="margin-top: 20px; padding: 10px; background: #222; border-radius: 3px;">
                                <div style="color: #00a2ff; margin-bottom: 5px; font-size: 14px;">
                                    <i class="fas fa-align-left"></i> Description
                                </div>
                                <div style="color: #ccc; font-size: 13px;">${escapeHtml(data.description)}</div>
                            </div>
                        ` : ''}
                        
                        <div style="margin-top: 20px; display: flex; gap: 10px;">
                            <a href="${data.profileUrl}" target="_blank" style="
                                background: #00a2ff;
                                color: white;
                                padding: 8px 15px;
                                border-radius: 3px;
                                text-decoration: none;
                                font-size: 14px;
                                display: inline-flex;
                                align-items: center;
                                gap: 5px;
                            ">
                                <i class="fas fa-external-link-alt"></i> View Profile
                            </a>
                            <button onclick="addRobloxToDatabase('${escapeHtml(data.username)}', ${data.id})" style="
                                background: #003300;
                                color: #00ff00;
                                border: 1px solid #005500;
                                padding: 8px 15px;
                                border-radius: 3px;
                                cursor: pointer;
                                font-size: 14px;
                                display: inline-flex;
                                align-items: center;
                                gap: 5px;
                            ">
                                <i class="fas fa-save"></i> Save to Database
                            </button>
                        </div>
                        
                        <div style="margin-top: 15px; color: #666; font-size: 12px; border-top: 1px solid #333; padding-top: 10px;">
                            <i class="fas fa-info-circle"></i> Data fetched from Roblox Public API ‚Ä¢ Last updated: ${data.lastUpdated}
                        </div>
                    </div>
                </div>
            `;
        }

        function addRobloxToDatabase(username, userId) {
            if (!isAuthenticated) return;
            
            const identifier = `roblox:${username}`;
            const existingIndex = osintDatabase.findIndex(item => item.identifier === identifier);
            
            if (existingIndex !== -1) {
                if (!confirm("This Roblox user already exists in database. Update?")) return;
            }
            
            const robloxData = {
                username: username,
                userId: userId,
                profileUrl: `https://www.roblox.com/users/${userId}/profile`,
                addedAt: new Date().toISOString(),
                source: "Roblox API Lookup"
            };
            
            if (existingIndex !== -1) {
                osintDatabase[existingIndex].data = JSON.stringify(robloxData, null, 2);
                osintDatabase[existingIndex].timestamp = new Date().toISOString();
            } else {
                osintDatabase.push({
                    identifier: identifier,
                    data: JSON.stringify(robloxData, null, 2),
                    timestamp: new Date().toISOString(),
                    id: Date.now()
                });
            }
            
            localStorage.setItem('tniOsintDatabase', JSON.stringify(osintDatabase));
            updateStats();
            showNotification(`Roblox user ${username} saved to database`);
        }

        // ====================
        // ENHANCED SEARCH FUNCTION
        // ====================
        async function enhancedSearch() {
            if (!isAuthenticated) return;
            
            const searchTerm = document.getElementById('searchInput').value.trim();
            if (!searchTerm) {
                document.getElementById('resultsDisplay').innerHTML = '<div class="no-results">Enter search term to query database</div>';
                document.getElementById('apiResultsSection').style.display = 'none';
                return;
            }
            
            // Update last search stat
            document.getElementById('lastSearch').textContent = searchTerm.substring(0, 15) + (searchTerm.length > 15 ? '...' : '');
            
            // 1. Search local database
            const localResults = searchLocalDatabase(searchTerm);
            displayLocalResults(localResults);
            
            // 2. Check if it might be a Roblox username/ID and search
            document.getElementById('apiResultsSection').style.display = 'none';
            document.getElementById('apiResultsDisplay').innerHTML = '<div style="color: #888; padding: 20px; text-align: center;">Checking external sources...</div>';
            
            // Simple heuristic for Roblox: numeric ID or common username pattern
            const couldBeRoblox = /^\d+$/.test(searchTerm) || /^[a-zA-Z0-9_]{3,20}$/.test(searchTerm);
            
            if (couldBeRoblox) {
                try {
                    const robloxData = await checkRobloxUser(searchTerm);
                    displayRobloxResults(robloxData, searchTerm);
                } catch (error) {
                    console.error("Roblox search failed:", error);
                }
            }
        }

        // ====================
        // UTILITY FUNCTIONS
        // ====================
        function updateStats() {
            if (!isAuthenticated) return;
            
            document.getElementById('totalEntries').textContent = osintDatabase.length;
            const dataStr = JSON.stringify(osintDatabase);
            const bytes = new TextEncoder().encode(dataStr).length;
            const kb = (bytes / 1024).to
